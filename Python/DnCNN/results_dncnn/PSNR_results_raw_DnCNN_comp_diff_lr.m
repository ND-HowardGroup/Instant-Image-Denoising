close all
clear variables
clc

%Varun Mannam
%date: taken from 29th Sep 2019
%date: 27th July 2020
%DnCNN model with diff lr in keras
%calculate the PSNR on test-mix data raw nbn

%1e-3 100 epochs with adjust LR and weights initialization
%5e-4 200 epochs with adjust LR and weights initialization
%1e-4 200 epochs with adjust LR and weights initialization
%5e-5 200 epochs with adjust LR and weights initialization

format long
font = 14;
linewidth = 2;
format long;

input_snr = [31.0013994757380;32.4355944495239;30.8389376260123;30.1446963613668;22.8898419300006;25.4380806137492;31.4129562671116;33.2714634385635;33.2687423523874;22.8804735366571;25.6158044368661;22.8279560741158;25.6370939543658;33.0234393128250;25.6158044368661;22.8580037151022;23.8972761467197;24.9514139990449;24.9832541276875;23.8755250603244;24.3188985682586;23.8605156142818;25.2263003138287;23.9044985921393;23.6688313676180;32.2013251950805;24.1923646677596;26.2300198751109;24.7010303920376;26.2356203085374;32.0904729461831;31.8870667992703;24.4086429479671;26.2348882344496;31.7707628427737;26.2283210436201;24.9907764180876;29.3709502307532;28.7487655843002;28.6149527091447;28.1247666427617;25.5706915349250;29.3276646439983;28.2432957509904;29.3725190518817;25.4384495835989;25.2179004485139;29.3606855385532];
est_dncnn_new_lr1 = [38.5898071945099;37.1241399799217;38.5560261178342;37.5603915820735;32.1032134857285;32.9523388168424;36.6133636241133;38.8012333269787;36.5575599689120;32.1249967022883;34.2989841257804;32.2050754846177;34.1908599679487;38.3038108138190;34.2989841257804;32.1667309346691;32.4061912354171;34.5133689450863;34.5449343745882;32.1946433825830;32.3026475249917;32.2547226910440;34.5366190200611;32.3136147700832;29.9791601198679;38.9687830405257;29.1602758103866;34.4427615529372;32.5692813976340;34.6869846230913;38.8215858359430;36.7532272821205;32.2845808593429;34.4760571548913;37.7320666315171;34.6211630598855;32.5596288360884;37.7226730559167;34.1901130621131;33.4691433498316;31.6323535938467;31.7494753627497;37.5483008664445;33.5182143843638;37.6484382940785;33.0888029669955;32.8698346348783;37.6068848101040]; %1e-3 100 epochs
est_dncnn_new_lr2 = [38.6862577825502;37.2481797546039;38.6136910715989;37.5567045109012;32.1513667381817;33.0156162734819;36.7762517899027;38.8662748671885;36.5646454914975;32.1883138133440;34.5258960851645;32.2095171405031;34.3486949262450;38.4107073903271;34.5258960851645;32.1898587460699;32.4404825929695;34.6863991805838;34.4671840306061;32.2696450206732;32.5742749679221;32.2764360041041;34.4267921578438;32.3842295794061;30.6685135811662;39.0588219286216;29.1821500945868;34.5603429869517;32.4313686586257;34.7764462152414;38.9050996777309;36.7012046170458;32.7940699458198;34.5849038172936;37.8518113818703;34.7267956451457;32.6179049683708;37.7932250963802;34.2783047210348;33.5386049203656;31.6606316095406;31.8963980296168;37.5610279512199;33.7828778658481;37.7058616210584;33.1968244460565;32.9602259037770;37.6845605709566]; %5e-4 200 epochs
est_dncnn_new_lr3 = [38.6876888989313;37.2895928039955;38.6171529795876;37.6395654375508;32.1054660419379;32.6079738508205;36.6882606798161;38.8347202771923;36.4706427875978;32.1349993797481;34.1134057853294;32.1682077637245;33.8127147885839;38.4212851111280;34.1134057853294;32.1414965381606;32.1829565696255;34.7143084280493;34.5919507668820;32.0287071321922;32.6250298065970;32.0684572888356;34.5180006489852;32.1236686839665;30.3225883594635;39.0783209291882;29.1539354852920;34.6589876673135;32.4433025660558;34.8912005333701;38.9130092161690;36.6706179965241;32.5167494231264;34.6581535270014;37.8678759822706;34.8464391993725;32.6087565600477;37.7759571831726;34.1549602604242;33.4206704256152;31.5691656133701;31.7242069630827;37.5155352063647;33.7208049382106;37.6331091790418;33.0765168011501;32.9016624644074;37.6569995284861]; %1e-4 200 epochs
est_dncnn_new_lr4 = [38.5381025826331;37.1769267241885;38.5031292716404;37.5906947748239;31.6405501451539;32.0953795903791;36.5264877565984;38.6562996756858;36.3376336328556;31.6880102430567;33.2174052536134;31.7095288191115;33.0973267415101;38.2659442485232;33.2174052536134;31.6655321105882;31.8706649039532;34.3270334254426;34.2763571055054;31.7380847511799;32.2781525230515;31.7766000286912;34.1989852629582;31.8126346007794;29.9659697164993;38.9186722589584;28.9038369917017;34.4085329816770;32.0910266978200;34.6164473683761;38.7647557835268;36.6087261901496;32.1045137538832;34.4084858742077;37.7282460587271;34.5816253448420;32.4038764844361;37.4564261304735;33.9355539208818;33.2390464627830;31.4599032386009;31.5476747630063;37.2639797334869;33.4579645765018;37.3519479184744;32.8583884263186;32.6774442535190;37.3611535269447]; %5e-5 200 epochs


x=[1:48]';
% figure, 
% plot(x,input_snr,'k*-', 'Linewidth', linewidth);
% hold on
% plot(x,est_lr1,'bo-', 'Linewidth', linewidth);
% plot(x,est_lr2,'rs-', 'Linewidth', linewidth);
% plot(x,est_lr3,'gd-', 'Linewidth', linewidth);
% xlabel('Input PSNR');
% ylabel('PSNR comparision');
% title('Validation loss DnCNN Keras');
% legend('lr1= 1e-4', 'lr2= 5e-4', 'lr3= 1e-3', 'Location', 'best');
% %colormap(gray); colorbar;
% set(gca,'FontSize',font);


figure, 
plot(x,input_snr,'k*-', 'Linewidth', linewidth);
hold on
plot(x,est_dncnn_new_lr1,'bo-', 'Linewidth', linewidth);
plot(x,est_dncnn_new_lr2,'rs-', 'Linewidth', linewidth);
plot(x,est_dncnn_new_lr3,'gd-', 'Linewidth', linewidth);
plot(x,est_dncnn_new_lr4,'m--', 'Linewidth', linewidth);

xlabel('Sample index');
ylabel('PSNR comparision');
title('PSNR DnCNN new results Keras');
legend('Input PSNR','lr1= 1e-3 (100 epochs)', 'lr2= 1e-4 (200 epochs)', 'lr3= 1e-4 (200 epochs)','lr4= 5e-5 (200 epochs)', 'Location', 'best');
%colormap(gray); colorbar;
set(gca,'FontSize',font);