close all
clear variables
clc

%Varun Mannam
%date: taken from 29th Sep 2019
%date: 30th May 2020
%DnCNN model with diff lr in keras
%calculate the PSNR on test-mix data raw nbn

%new result with lr=1e-3 and diff LR values and weights initalization
%new result with lr=1e-4 and diff LR values and weights initalization
%new result with lr=5e-4 and diff LR values and weights initalization
%new result with lr=5e-5 and diff LR values and weights initalization
%new result with lr=1e-5 and diff LR values and weights initalization

format long
font = 14;
linewidth = 2;
format long;

input_snr = [31.0013994757380;32.4355944495239;30.8389376260123;30.1446963613668;22.8898419300006;25.4380806137492;31.4129562671116;33.2714634385635;33.2687423523874;22.8804735366571;25.6158044368661;22.8279560741158;25.6370939543658;33.0234393128250;25.6158044368661;22.8580037151022;23.8972761467197;24.9514139990449;24.9832541276875;23.8755250603244;24.3188985682586;23.8605156142818;25.2263003138287;23.9044985921393;23.6688313676180;32.2013251950805;24.1923646677596;26.2300198751109;24.7010303920376;26.2356203085374;32.0904729461831;31.8870667992703;24.4086429479671;26.2348882344496;31.7707628427737;26.2283210436201;24.9907764180876;29.3709502307532;28.7487655843002;28.6149527091447;28.1247666427617;25.5706915349250;29.3276646439983;28.2432957509904;29.3725190518817;25.4384495835989;25.2179004485139;29.3606855385532];
est_unet_nbn_lr1 = [38.6828269073526;36.9707244798673;38.5360523851837;37.4106502356133;32.5877060536318;34.9653229888154;37.0983085363912;38.5516797521725;36.7517750346483;32.5995295675883;36.9610919635778;32.7022021576001;36.6677331993658;38.1051410566740;36.9610919635778;32.5975394464369;33.1368578463013;35.1499467372220;35.0191482528900;32.8752588552507;33.1347163264101;32.9425457097877;34.7822346665678;33.0136882112433;30.9319937788734;38.9013590132681;29.3562690395516;34.9908974177672;32.7696109888120;35.1828155932056;38.7487126767430;36.9422574496551;33.3425186617546;34.9551082849084;37.6466062550410;35.1001046190384;33.0589472528558;37.9193413818550;34.3323443748830;33.6006129862428;31.7592487168480;31.9524161794368;37.7064941259831;33.8387061072764;37.8398974804300;33.3764852387709;33.3086699500341;37.8013811345292];
est_unet_nbn_lr2 = [38.8517654639436;37.4344889357289;38.7175275110881;37.6745307346400;32.7888003571591;35.4404031506365;37.1879159035871;39.0081440091074;36.5411768320094;32.8031584744728;37.7892263202473;32.9177328652483;37.3611965442523;38.6188747733386;37.7892263202473;32.8111065529059;33.3567777884529;35.3088646024798;34.8799764755131;33.1110725816653;34.1672891657785;33.2013294862293;34.6174004254979;33.1787692956681;31.9611646071583;39.2665134684923;29.6151514071631;35.2440671518927;32.6616889896428;35.5350624985714;39.0672284111752;36.8680676073156;33.7204436756546;35.2677210814444;38.0148521746611;35.4146949586307;32.8960031788340;38.2429652495634;34.0326572400501;33.2912682879261;31.5654823932499;32.4910591294210;38.1204169208269;34.3102162089995;38.2078705857879;33.0599223067870;33.1528816437815;38.1912613556894];
est_unet_nbn_lr3 = [38.9497606304002;37.5517981132943;38.8838839713782;38.0316296667047;32.8202064549674;35.4852152877357;37.1833234872747;39.1566462389781;36.6414866947144;32.8282219821557;38.0540092638705;32.9626318188055;37.5296030133339;38.7352165387498;38.0540092638705;32.8446374493366;33.4091402009013;35.1173363647407;34.4822794322389;33.1972739418756;34.4251946319013;33.2340745347781;34.1848843080270;33.2669596942133;31.9181690092946;39.4591268442312;29.1587610211753;35.4403487590835;31.8793544970598;35.7652691320288;39.3120981561344;36.6596699610597;33.4529998116285;35.4044415842182;38.2274596463039;35.6267089456678;32.4811207851238;38.4227395933551;34.0680721892334;33.3513490636338;31.5998648315621;32.4362136494476;38.2700359667792;34.2620547650573;38.3494521659096;32.8893218582341;32.8042847628976;38.3399777258297];
est_unet_nbn_lr4 = [38.5952021210901;37.2200477210246;38.3853914013468;37.0552264894862;32.6025224908649;35.2614410328832;37.3454225309768;38.7567861421417;36.5159229290206;32.6203790728787;37.3160952407577;32.7432875210829;37.0429552622693;38.3583554468883;37.3160952407577;32.6452743102475;33.2276605614712;35.2626879282948;34.8976130519088;32.9907498720883;33.7658341932510;33.0680079134460;34.5680722191477;33.0908923716690;31.6092304812454;38.9480665313688;29.7238468935439;35.0294005030717;32.8008577308952;35.3103302757794;38.7489628950623;37.0084293452427;33.5347883383048;35.0619946828420;37.7181239809286;35.2203667433059;33.0866793021597;38.1203888242613;34.1925689062123;33.4379477357087;31.6895325288279;32.2739807709835;37.9278676166662;34.0951231553755;38.0598711835653;33.1559562932446;33.2673581199707;38.0327487463469];
est_unet_nbn_lr5 = [38.1777237937270;36.5431970656107;37.8637564984702;36.6494137350524;31.1267989963525;33.0658097470522;37.3013501820598;37.8792947177338;36.4424914306922;31.1392663401526;34.3976036911767;31.2597291672376;34.2521433093168;37.5071949864380;34.3976036911767;31.2048138588575;32.5370238564589;34.6362121975235;34.3198072461489;32.3068447514555;33.2074796335381;32.3811928775084;33.9086918797944;32.4309062174161;30.8237960998041;38.1048940224971;28.8601221411598;34.0708905790843;31.9873035388404;34.2972328046948;37.9474140218734;36.4398305312297;32.9716990962628;34.0551864543803;37.0327650945706;34.1919046479664;32.6293774476883;36.5251070828214;33.4795890443648;32.8935564997507;31.2845027321608;31.2344609699121;36.4139032271602;33.0195449254771;36.4821540962413;32.6086329894514;32.7431552712140;36.4673545978088];

x=[1:48]';
% figure, 
% plot(x,input_snr,'k*-', 'Linewidth', linewidth);
% hold on
% plot(x,est_lr1,'bo-', 'Linewidth', linewidth);
% plot(x,est_lr2,'rs-', 'Linewidth', linewidth);
% plot(x,est_lr3,'gd-', 'Linewidth', linewidth);
% xlabel('Input PSNR');
% ylabel('PSNR comparision');
% title('Validation loss DnCNN Keras');
% legend('lr1= 1e-4', 'lr2= 5e-4', 'lr3= 1e-3', 'Location', 'best');
% %colormap(gray); colorbar;
% set(gca,'FontSize',font);


figure, 
plot(x,input_snr,'k*-', 'Linewidth', linewidth);
hold on
plot(x,est_unet_nbn_lr1,'bo-', 'Linewidth', linewidth);
plot(x,est_unet_nbn_lr2,'rs-', 'Linewidth', linewidth);
plot(x,est_unet_nbn_lr3,'gd-', 'Linewidth', linewidth);
plot(x,est_unet_nbn_lr4,'m+-', 'Linewidth', linewidth);
plot(x,est_unet_nbn_lr5,'c--', 'Linewidth', linewidth);
xlabel('#Images');
ylabel('PSNR comparison');
title('PSNR UNet NBN Keras (new)');
legend('Input PSNR', 'lr1= 1e-3', 'lr2= 1e-4', 'lr3= 5e-4', 'lr4= 5e-5', 'lr5= 1e-5','Location', 'best');
%colormap(gray); colorbar;
set(gca,'FontSize',font);