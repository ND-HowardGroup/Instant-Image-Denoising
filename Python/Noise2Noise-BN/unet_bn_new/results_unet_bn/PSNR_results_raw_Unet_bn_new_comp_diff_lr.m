close all
clear variables
clc

%Varun Mannam
%date: taken from 29th Sep 2019
%date: 30th May 2020
%DnCNN model with diff lr in keras
%calculate the PSNR on test-mix data raw nbn

%new result with lr=1e-3 and diff LR values and weights initalization
%new result with lr=1e-4 and diff LR values and weights initalization
%new result with lr=5e-4 and diff LR values and weights initalization
%new result with lr=5e-5 and diff LR values and weights initalization
%new result with lr=1e-5 and diff LR values and weights initalization

format long
font = 14;
linewidth = 2;
format long;

input_snr = [31.0013994757380;32.4355944495239;30.8389376260123;30.1446963613668;22.8898419300006;25.4380806137492;31.4129562671116;33.2714634385635;33.2687423523874;22.8804735366571;25.6158044368661;22.8279560741158;25.6370939543658;33.0234393128250;25.6158044368661;22.8580037151022;23.8972761467197;24.9514139990449;24.9832541276875;23.8755250603244;24.3188985682586;23.8605156142818;25.2263003138287;23.9044985921393;23.6688313676180;32.2013251950805;24.1923646677596;26.2300198751109;24.7010303920376;26.2356203085374;32.0904729461831;31.8870667992703;24.4086429479671;26.2348882344496;31.7707628427737;26.2283210436201;24.9907764180876;29.3709502307532;28.7487655843002;28.6149527091447;28.1247666427617;25.5706915349250;29.3276646439983;28.2432957509904;29.3725190518817;25.4384495835989;25.2179004485139;29.3606855385532];
est_unet_bn_lr1 = [38.7426259270520;37.1270618679928;38.6147132420469;37.4654652296689;32.5566253828139;34.1634525158629;37.0417109635572;38.6057422822253;36.4754722371336;32.5887963208318;35.9942516495477;32.6744846348917;35.6974127545516;38.2025281021873;35.9942516495477;32.5873833722394;33.0936626678087;35.0971021155006;34.7983195150691;32.8494724206615;32.9795303795033;32.9261874812177;34.7802964107334;32.9419131493044;30.9358313819677;39.1230701970462;29.3281775337241;34.8997429538858;32.5532726570866;35.1162140846999;38.9528104738109;36.7462322529671;32.9995360432205;34.9061830881875;37.9129222208102;35.0397347415482;32.7293372515064;38.0940104800699;34.3552643677791;33.6362253705282;31.8094481972912;32.1283576212326;37.8567251575686;33.8059486403210;38.0080729580724;33.4005472792769;33.1158773982727;37.9894291669749];
est_unet_bn_lr2 = [38.5457224410139;37.1161795021423;38.4833285154908;37.4254928872610;32.4136669666856;33.8466971467859;36.7120751522168;38.4945675814007;36.3277836388395;32.4605909504623;34.4114553467239;32.5568351575848;34.6749117039777;38.1387298727815;34.4114553467239;32.4556760984523;32.7684893179818;34.8971967962096;34.6999843674444;32.6031687395999;33.0109643697924;32.5817860316573;34.5155807656161;32.7437830147336;30.5916742511224;38.8388192993304;29.4349116455298;34.7428507469775;32.7075377840624;34.9968784389942;38.6671411794118;36.9710656773484;32.8719313481999;34.7530906619681;37.6509311673953;34.8976791528928;32.6734867550249;37.7848334447473;34.0950819442161;33.3958492639172;31.6380253953803;32.0179817016514;37.5546670010937;33.6781526661506;37.7228841956296;33.2487167281554;33.0300989701706;37.6820139615477];
est_unet_bn_lr3 = [38.7282645896840;37.1430190205809;38.6284841215423;37.5008865456816;32.6590596525190;34.3418549809097;36.9971022324741;38.5856384574733;36.4881924613383;32.6660400818312;36.1685000051800;32.7991910967675;35.8736914023781;38.1888513306305;36.1685000051800;32.7097315950039;33.0505205147360;35.1199859635289;34.9057920272288;32.8284550681938;33.0491064214275;32.8867615591666;34.8402430786661;32.9255268163725;31.2616552096799;39.0728493326355;29.4941923411871;34.7209951892081;32.7389052953481;34.9925499434588;38.9373631952974;36.7151665481045;33.4545771493388;34.7495770699502;37.9172905078933;34.8725234146091;32.9553697654747;38.0595256663175;34.3857568130381;33.6457179360828;31.8020039449572;32.1218784134871;37.8214666629760;33.8793649642607;37.9742148508818;33.4582899627832;33.2880990860609;37.9464516787734];
est_unet_bn_lr4 = [38.4517554058088;37.0033275298127;38.4293591196554;37.4770036809134;32.1928633007751;32.7731842385651;36.5727307946539;38.2687805124724;36.1208202833342;32.2221936350791;33.6711293955764;32.3380073755085;33.7171786735163;37.9428709679926;33.6711293955764;32.2459669066092;32.7880101795682;34.7467639853211;34.5237071639885;32.5262300129260;32.8353433476027;32.6359171315156;34.3289031165277;32.6267032194929;29.9646038506535;38.7222709568487;29.2772149646590;34.8064621610446;32.6146446378347;35.0637488901737;38.6252266611300;36.7127802653610;32.2812761066092;34.8181913702369;37.6141890336818;34.9978140703786;32.7305663848352;37.5453797158445;33.8140334759653;33.1349192613246;31.4461269754024;31.7026922635174;37.3038829617086;33.4691439161731;37.4572559888840;33.0669406984120;32.9750655454445;37.4257238642492];
est_unet_bn_lr5 = [37.6322937742614;36.0879505011906;37.6071652888136;37.1436485496454;31.1000105956853;28.9821025243496;35.7495700292573;36.8989592390092;34.9642361105837;31.0999163975567;30.0053216737628;31.1510379010196;29.7240541834619;36.7404932490824;30.0053216737628;31.1842522946465;30.9021566584994;33.5627004917935;33.5832840236539;30.7983886009061;31.7693841297564;30.7897052341277;33.5352069343985;30.8944654691972;28.8298773872646;37.7685527938355;28.8161187112068;32.7965679172418;31.6680684176691;32.9802630728746;37.6027443504583;36.3470764123206;30.8635754072503;32.8619985682081;36.8222351240295;32.9252689744566;32.1667481383683;36.6524313641110;32.6269308683922;32.0727219086040;30.6840462442496;31.0552944841817;36.5185554413574;32.4174905694412;36.6055230420933;32.3686245909421;32.3642069779847;36.6168718413487];


x=[1:48]';
% figure, 
% plot(x,input_snr,'k*-', 'Linewidth', linewidth);
% hold on
% plot(x,est_lr1,'bo-', 'Linewidth', linewidth);
% plot(x,est_lr2,'rs-', 'Linewidth', linewidth);
% plot(x,est_lr3,'gd-', 'Linewidth', linewidth);
% xlabel('Input PSNR');
% ylabel('PSNR comparision');
% title('Validation loss DnCNN Keras');
% legend('lr1= 1e-4', 'lr2= 5e-4', 'lr3= 1e-3', 'Location', 'best');
% %colormap(gray); colorbar;
% set(gca,'FontSize',font);


figure, 
plot(x,input_snr,'k*-', 'Linewidth', linewidth);
hold on
plot(x,est_unet_bn_lr1,'bo-', 'Linewidth', linewidth);
plot(x,est_unet_bn_lr2,'rs-', 'Linewidth', linewidth);
plot(x,est_unet_bn_lr3,'gd-', 'Linewidth', linewidth);
plot(x,est_unet_bn_lr4,'m+-', 'Linewidth', linewidth);
plot(x,est_unet_bn_lr5,'c--', 'Linewidth', linewidth);
xlabel('#Images');
ylabel('PSNR comparision');
title('PSNR UNet BN Keras (new)');
legend('Input PSNR', 'lr1= 1e-3', 'lr2= 1e-4', 'lr3= 5e-4', 'lr4= 5e-5', 'lr5= 1e-5','Location', 'best');
%colormap(gray); colorbar;
set(gca,'FontSize',font);